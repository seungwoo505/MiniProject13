<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>파일 업데이트 테스트 (파일 업로드 방식)</title>
  <!-- 부트스트랩 CSS (간단한 스타일 적용) -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <!-- axios CDN -->
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
  <div class="container mt-4">
    <h1>파일 업데이트 테스트</h1>
    
    <!-- 파일 ID 입력 -->
    <div class="form-group">
      <label for="fileId">파일 ID:</label>
      <input type="text" id="fileId" class="form-control" placeholder="업데이트할 파일 ID">
    </div>
    
    <!-- 새 파일 이름 입력 -->
    <div class="form-group">
      <label for="newFileName">새 파일 이름:</label>
      <input type="text" id="newFileName" class="form-control" placeholder="새 파일 이름">
    </div>
    
    <!-- 새 파일 선택 -->
    <div class="form-group">
      <label for="fileInput">새 파일 선택:</label>
      <input type="file" id="fileInput" class="form-control-file">
    </div>
    
    <button id="updateBtn" class="btn btn-primary">파일 업데이트</button>
    <div id="result" class="mt-3"></div>
  </div>

  <script>
    document.getElementById('updateBtn').addEventListener('click', function() {
      const fileId = document.getElementById('fileId').value.trim();
      const newFileName = document.getElementById('newFileName').value.trim();
      const fileInput = document.getElementById('fileInput');
      
      if (!fileId || fileInput.files.length === 0) {
        alert("모든 필드를 입력하고 파일을 선택하세요.");
        return;
      }
      
      // 선택된 파일 가져오기
      const file = fileInput.files[0];
      
      // FormData에 파일과 새 파일 이름 추가
      const formData = new FormData();
      formData.append("file", file);
      formData.append("userId", "이승우");
      formData.append("fileId", fileId);
      
      // API 엔드포인트: 파일 ID에 해당하는 파일 업데이트 (URL은 실제 서버 API에 맞게 수정)
      axios.post("http://localhost:8080/updateFile", formData, {
        headers: {
          'Content-Type': 'multipart/form-data'
        }
      })
      .then(response => {
        document.getElementById('result').innerHTML = `<div class="alert alert-success">업데이트 성공: ${response.data}</div>`;
      })
      .catch(error => {
        console.error(error);
        let errorMsg = error.response && error.response.data ? error.response.data : error.message;
        document.getElementById('result').innerHTML = `<div class="alert alert-danger">업데이트 실패: ${errorMsg}</div>`;
      });
    });
  </script>
</body>
</html>
